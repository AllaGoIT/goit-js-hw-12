{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["\nimport axios from \"axios\";\n\nconst BASE_URL = \"https://pixabay.com/api/\";\naxios.defaults.baseURL = BASE_URL ;\nconst API_KEY = '43918725-f2c9edad28ee6306c974c89a7';\nexport const PER_PAGE = 15;\n\nexport const fetchPhotosCats = async (query = \"cat\", imagePage = 1) => {\n  try {\nconst searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: \"photo\",\n    orientation: 'horizontal',\n    safesearch: \"true\",\n    per_page: PER_PAGE,\n    page:imagePage,\n    // _limit: 15,\n    // _sort: \"name\",\n  });\n    const { data } = await axios.get(`${BASE_URL}?${searchParams}`);\n    return data;\n  }\n  catch (error){\n    console.log(error);\n  }\n}\n","\nconst galEl = document.querySelector(\"ul.gallery\");\nconst btnmEl = document.querySelector(\".btn-more\");\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captionPosition: 'bottom',\n    captionDelay: 250,\n    captionsData: 'alt',\n});\n\n  export const createGalleryList = async images => {\n    const markUp = await images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n     <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${webformatURL}\"\n          alt=\"${tags}\"\n        />\n        <div class=\"text-list\">\n          <p class=\"text-likes\">Likes:${likes}</p> \n          <p class=\"text-views\">Views: ${views}</p>\n          <p class=\"text-coments\">Comments: ${comments}</p>\n         <p class=\"text-downloads\">Downloads: ${downloads}</p>\n        </div>\n      </a>\n    </li>\n    `).join(\"\");\n\n    galEl.insertAdjacentHTML(\"beforeend\", markUp);\n    lightbox.refresh();\n    \n    const loadEl = document.querySelector(\".loader\");\n    loadEl.style.visibility = \"hidden\";\n    loadEl.style.pointerEvents = \"none\";\n    btnmEl.classList.remove('d-none');\n  }\n","\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { fetchPhotosCats } from \"./js/pixabay-api.js\";\nimport { createGalleryList } from \"./js/render-functions.js\";\nimport { PER_PAGE } from \"./js/pixabay-api.js\";\n\nconst formEl = document.querySelector(\".form\");\nconst loadEl = document.querySelector(\".loader\");\nconst galEl = document.querySelector(\"ul.gallery\");\nconst btnmEl = document.querySelector(\".btn-more\");\n\n let searchQuery;\n let imagePage = 1;\n let totalPages = 0;\n\nbtnmEl.classList.add(\"d-none\");\n\nformEl.addEventListener(\"submit\", onSubmit);\n\nfunction onSubmit(event) {\n  event.preventDefault();\n  searchQuery = event.target.elements[0].value.trim();\n  event.target.reset();\n  loadEl.style.visibility = \"visible\";\n  loadEl.style.pointerEvents = \"all\";\n\n  if (searchQuery) {\n    fetchPhotosCats(searchQuery).then(json => {\n      try {\n        if (json.total === 0) {\n          loadEl.style.visibility = \"hidden\";\n          loadEl.style.pointerEvents = \"none\";\n          throw new Error((\n            iziToast.show({\n              position: 'topRight',\n              message: \"Sorry, there are no images matching your search query. Please try again!\",\n              color: 'red',\n              close: true,\n            })\n          ));\n        }\n        createGalleryList(json.hits);\n        if (PER_PAGE < json.total) {\n          totalPages = Math.ceil(json.total / PER_PAGE);\n          if (totalPages > 1) {\n            btnmEl.classList.remove('d-none');\n          }\n        }\n        console.log(json);\n        console.log(totalPages);\n      }\n      catch (error) {\n        console.log(error);\n      };\n      galEl.innerHTML = \"\";\n    })\n  };\n}\n    \nconst smoothScrollOnLoadMore = () => {\n  const lastImage = galEl.querySelector('li.gallery-item');\n  const imageHeight = lastImage.getBoundingClientRect().height;\n  const scrollHeight = imageHeight * 2;\n  console.log(scrollHeight);\n\n  window.scrollBy({\n    top: imageHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n};\n\nconst onLoadMorePressed = async event => {\n  try {\n       \n    imagePage += 1;\n    btnmEl.classList.remove('d-none');\n\n    // Get news data\n    const  data  = await fetchPhotosCats(searchQuery, imagePage);\n    //console.log(data);\n    // Render news\n    if (data.total === 0) {\n      loadEl.style.visibility = \"hidden\";\n      loadEl.style.pointerEvents = \"none\";\n      throw new Error((\n        iziToast.show({\n          position: 'topRight',\n          message: \"Sorry, there are no images matching your search query. Please try again!\",\n          color: 'red',\n          close: true,\n        })\n      ));\n    }\n    createGalleryList(data.hits);\n   \n    btnmEl.classList.add('d-none');\n    smoothScrollOnLoadMore();\n\n    // Hide button if reach end of collection\n    if (imagePage > totalPages) {\n      btnmEl.classList.add('d-none');\n      btnmEl.removeEventListener('click', onLoadMorePressed);\n    }\n  } catch (error) {\n    console.log(error);\n    iziToast.error({\n      message: \"We're sorry, but you've reached the end of search results\",\n      position: 'topRight',\n      timeout: 2000,\n    });\n  }\n};\n    \nbtnmEl.addEventListener(\"click\", onLoadMorePressed);\n"],"names":["BASE_URL","axios","API_KEY","PER_PAGE","fetchPhotosCats","query","imagePage","searchParams","data","error","galEl","btnmEl","lightbox","SimpleLightbox","createGalleryList","images","markUp","webformatURL","largeImageURL","tags","likes","views","comments","downloads","loadEl","formEl","searchQuery","totalPages","onSubmit","event","json","iziToast","smoothScrollOnLoadMore","imageHeight","scrollHeight","onLoadMorePressed"],"mappings":"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"}