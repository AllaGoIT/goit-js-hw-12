{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["\nimport axios from \"axios\";\n\nconst BASE_URL = \"https://pixabay.com/api/\";\naxios.defaults.baseURL = BASE_URL ;\nconst API_KEY = '43918725-f2c9edad28ee6306c974c89a7';\nexport const PER_PAGE = 15;\n\nexport const fetchPhotosCats = async (query = \"cat\", imagePage = 1) => {\n  try {\nconst searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: \"photo\",\n    orientation: 'horizontal',\n    safesearch: \"true\",\n    per_page: PER_PAGE,\n    page:imagePage,\n  });\n    const { data } = await axios.get(`${BASE_URL}?${searchParams}`);\n    return data;\n  }\n  catch (error){\n    console.log(error);\n  }\n}\n","\nconst galEl = document.querySelector(\"ul.gallery\");\nconst btnmEl = document.querySelector(\".btn-more\");\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captionPosition: 'bottom',\n    captionDelay: 250,\n    captionsData: 'alt',\n});\n\n  export const createGalleryList = async images => {\n    const markUp = await images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n     <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${webformatURL}\"\n          alt=\"${tags}\"\n        />\n        <div class=\"text-list\">\n          <p class=\"text-likes\">Likes:${likes}</p> \n          <p class=\"text-views\">Views: ${views}</p>\n          <p class=\"text-coments\">Comments: ${comments}</p>\n         <p class=\"text-downloads\">Downloads: ${downloads}</p>\n        </div>\n      </a>\n    </li>\n    `).join(\"\");\n\n    galEl.insertAdjacentHTML(\"beforeend\", markUp);\n    lightbox.refresh();\n    \n    const loadEl = document.querySelector(\".loader\");\n    loadEl.style.visibility = \"hidden\";\n    loadEl.style.pointerEvents = \"none\";\n  }\n","\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { fetchPhotosCats } from \"./js/pixabay-api.js\";\nimport { createGalleryList } from \"./js/render-functions.js\";\nimport { PER_PAGE } from \"./js/pixabay-api.js\";\n\nconst formEl = document.querySelector(\".form\");\nconst loadEl = document.querySelector(\".loader\");\nconst galEl = document.querySelector(\"ul.gallery\");\nconst btnmEl = document.querySelector(\".btn-more\");\n\n let searchQuery;\n let imagePage = 1;\n let totalPages = 0;\n\nbtnmEl.classList.add(\"d-none\");\n\nformEl.addEventListener(\"submit\", onSubmit);\n\nfunction onSubmit(event) {\n  event.preventDefault();\n  searchQuery = event.target.elements[0].value.trim();\n  event.target.reset();\n  loadEl.style.visibility = \"visible\";\n  loadEl.style.pointerEvents = \"all\";\n\n  if (searchQuery) {\n    fetchPhotosCats(searchQuery).then(json => {\n      try {\n        if (json.total === 0) {\n          loadEl.style.visibility = \"hidden\";\n          loadEl.style.pointerEvents = \"none\";\n          throw new Error((\n            iziToast.show({\n              position: 'topRight',\n              message: \"Sorry, there are no images matching your search query. Please try again!\",\n              color: 'red',\n              close: true,\n            })\n          ));\n        }\n        createGalleryList(json.hits);\n        if (PER_PAGE < json.total) {\n          totalPages = Math.ceil(json.total / PER_PAGE);\n          if (totalPages > 1) {\n            btnmEl.classList.remove('d-none');\n          }\n        }\n      }\n      catch (error) {\n        //  iziToast.show({\n        //       position: 'topRight',\n        //       message: \"We're sorry, but you've reached the end of search results\",\n        //       color: 'red',\n        //       close: true,\n        //     })\n      };\n      galEl.innerHTML = \"\";\n      imagePage = 1;\n    })\n  };\n}\n    \n  const smoothScrollOnLoadMore = () => {\n  const lastImage = galEl.querySelector('li.gallery-item');\n  const imageHeight = lastImage.getBoundingClientRect().height;\n  const scrollHeight = imageHeight * 5 * imagePage + 100;\n  console.log(scrollHeight);\n\n  window.scrollBy({\n    top: scrollHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n};\n\nconst onLoadMorePressed = async event => {\n  try {\n       \n    imagePage += 1;\n    btnmEl.classList.remove('d-none');\n\n    const  data  = await fetchPhotosCats(searchQuery, imagePage);\n\n    if (data.total === 0) {\n      loadEl.style.visibility = \"hidden\";\n      loadEl.style.pointerEvents = \"none\";\n      throw new Error((\n        iziToast.show({\n          position: 'topRight',\n          message: \"Sorry, there are no images matching your search query. Please try again!\",\n          color: 'red',\n          close: true,\n        })\n      ));\n    }\n   await createGalleryList(data.hits);\n   \n    btnmEl.classList.add('d-none');\n   \n    if (imagePage > totalPages) {\n      btnmEl.classList.add('d-none');\n      btnmEl.removeEventListener('click', onLoadMorePressed);\n      iziToast.show({\n        position: 'topRight',\n        message: \"We're sorry, but you've reached the end of search results\",\n        color: 'red',\n        close: true,\n      })\n    }\n    else {\n      btnmEl.classList.remove('d-none');\n    }\n     smoothScrollOnLoadMore();\n  } catch (error) {\n    console.log(error);\n    // iziToast.error({\n    //   message: \"We're sorry, but you've reached the end of search results\",\n    //   position: 'topRight',\n    //   timeout: 2000,\n    // });\n  }\n};\n    \nbtnmEl.addEventListener(\"click\", onLoadMorePressed);\n"],"names":["BASE_URL","axios","API_KEY","PER_PAGE","fetchPhotosCats","query","imagePage","searchParams","data","error","galEl","lightbox","SimpleLightbox","createGalleryList","images","markUp","webformatURL","largeImageURL","tags","likes","views","comments","downloads","loadEl","formEl","btnmEl","searchQuery","totalPages","onSubmit","event","json","iziToast","smoothScrollOnLoadMore","scrollHeight","onLoadMorePressed"],"mappings":"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"}